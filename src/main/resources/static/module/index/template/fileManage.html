<div @drop.prevent="onDrop" @dragover.prevent="onDragover" @dragenter.prevent>
    <p class="basicInfo" style="position: relative;">
        文件管理
    </p>
    <el-row style="margin-top: 10px;">
        <div class="width100 d-flex a-center">
            <el-form-item label="web端同步路径:" label-width="125px" class="width30">
                <el-input type="text" v-model="webSyncPath" placeholder="请设置web端同步路径"
                          class="width100">
                </el-input>
            </el-form-item>
            <el-form-item label="手机端同步路径:" label-width="125px" class="width30">
                <el-input type="text" v-model="phoneSyncPath" placeholder="请设置手机端同步路径(以/sdcard为根路径)"
                          class="width100">
                </el-input>
            </el-form-item>
            <div class="width40 d-flex a-center" style="justify-content: right;margin-bottom:10px;">
                <div style="display: inline-flex;justify-content: flex-end;align-items: center;margin-left:0px;margin-right: 10px;">
                    <span>
                        自动同步web同步路径：
                    </span>
                    <el-switch v-model="autoSyncWebSyncPath"/>
                </div>
                <div style="display: inline-flex;justify-content: flex-end;align-items: center;margin-left:0px;margin-right: 10px;">
                    <span>
                        自动同步手机同步路径：
                    </span>
                    <el-switch v-model="autoSyncPhoneSyncPath"/>
                </div>
                <el-button @click.stop="syncFileToPhone">
                    同步到手机端
                </el-button>
                <el-button @click.stop="syncFileToWeb">
                    同步到web端
                </el-button>
            </div>
        </div>
    </el-row>

    <el-tabs v-model="fileActiveName" style="padding-left: 20px;margin-top: 0!important;">
        <el-tab-pane label="web端文件" name="web">
            <el-row style="padding-left: 0!important;">
                <div class="d-flex j-sb a-center width100">
                    <div class="d-flex a-center">
                        <el-button size="mini" type="primary" @click="uploadFileClick">上传文件</el-button>
                        <el-button size="mini" style="margin-left: 5px;"  type="primary" @click="createFolder">新建文件夹</el-button>
                    </div>
                    <input ref="input" style="display: none;" type="file" name="file" :multiple="true" :accept="accept" @change="handleChange">
                </div>
            </el-row>
            <el-row style="padding-left: 0!important;">
                <div class="d-flex j-sb a-center breadcrumbWrap" style="margin-top: 10px;margin-bottom: 10px;">
                    <el-breadcrumb separator="/">
                        <el-breadcrumb-item v-for="(item, i) in breadcrumbList" :key="i" class="pointer textHover" :class="{'endBreadcrumb': i !== 0 && i === breadcrumbList.length - 1, 'hoverBreadcrumb': breadcrumbList.length > 1 && i !== breadcrumbList.length - 1 }">
                            <span @click="breadcrumbChange(item, i)">{{ item.label }}</span>
                        </el-breadcrumb-item>
                    </el-breadcrumb>
                    <span class="primary-text-color font-14 keep-all">共{{ fileList.length }}个</span>
                </div>
            </el-row>
            <el-row style="padding-left: 0!important;">
                <div class="d-flex a-center fileOperate primary-text-color pl-1">
                    <el-tooltip class="item" v-if="copyFileList.length>0" effect="dark" :disabled="!copyFileNames" :content="copyFileNames" placement="top-start">
                        <span class="fileTips" >复制{{ copyFileList.length }}个文件(夹)</span>
                    </el-tooltip>
                    <el-tooltip class="item" v-else-if="moveFileList.length>0" effect="dark" :disabled="!allowMoveFileNames" :content="allowMoveFileNames" placement="top-start">
                        <span class="fileTips" >移动{{ allowMoveFileList.length }}个文件(夹)</span>
                    </el-tooltip>
                    <el-tooltip class="item" v-else="checkFileCount>0" effect="dark" :disabled="!checkFileNames" :content="checkFileNames" placement="top-start">
                        <span class="fileTips" >已选{{ checkFileCount }}个文件(夹)</span>
                    </el-tooltip>
                    <div class="operate d-flex a-center j-center">
                        <el-link v-if="checkFileCount>0" :underline="false" type="info" style="margin-left: 5px;" @click="operateFun('copy')">复制</el-link>
                        <el-link v-if="checkFileCount>0" :underline="false" type="info" style="margin-left: 5px;" @click="operateFun('move')">移动</el-link>
                        <el-link v-if="checkFileCount>0" :underline="false" type="info" style="margin-left: 5px;" @click="operateFun('remove')">删除</el-link>
                        <el-link v-if="copyFileList.length>0" :underline="false" type="info" style="margin-left: 5px;" @click="operateFun('paste')">粘贴到</el-link>
                        <el-link v-if="moveFileList.length>0" :underline="false" :disabled="!allowMoveFileList.length>0" type="info" style="margin-left: 5px;" @click="operateFun('moveTo')">移动到</el-link>
                        <el-link v-if="checkFileCount>0" :underline="false" type="info" style="margin-left: 5px;" @click="operateFun('syncToPhone')">同步到手机</el-link>
                        <el-link v-if="copyFileList.length>0 || moveFileList.length>0" :underline="false" type="info" style="margin-left: 5px;" @click="operateFun('cancel')">取消</el-link>
                    </div>
                </div>
            </el-row>
            <el-row style="padding-left: 0!important;">
                <div class="fileTableList" v-loading="fileLoading">
                    <div class="fileList-head d-flex a-center">
                        <div class="d-flex a-center fileName">
                            <el-checkbox v-model="checkAllFile" @change="checkAllFileChange" />
                            <span style="margin-left: 8px">文件名</span>
                        </div>
                        <div class="fileSize">文件大小</div>
                        <div class="lastUpdateTime">最后更新时间</div>
                        <div class="operate">操作</div>
                    </div>
                    <el-scrollbar class="right-scrollbar-wrap">
                        <div v-for="(item, index) in uploadFileList" :key="'upload'+index" class="fileList-head fileList-body d-flex a-center uploadFileHover">
                            <div class="d-flex a-center fileName">
                                <el-checkbox v-model="item.check" disabled />
                                <div class="fileNameWrap d-flex a-center flex-1">
                                    <span class="mr-16 text-fileName mt-0">{{ item.fileName }}</span>
                                </div>
                            </div>
                            <span class="iconfont" @click.stop.native="cancelUpload(index)">取消</span>
                            <el-progress :percentage="item.percentage" :stroke-width="3" />
                        </div>
                        <div v-for="(item,index) in fileList" :key="index" class="fileList-head fileList-body d-flex a-center">
                            <div class="d-flex a-center fileName">
                                <el-checkbox v-model="item.check" class="mr-5" @dblclick.stop.native />
                                <div class="fileNameWrap pointer d-flex a-center flex-1 mr-10" @dblclick="fileNameDbClick(item)" @click="fileClick(item)">
                                    <span class="mr-10 white-noWrap ellipsis-1 text-fileName mt-0" :title="item.fileName">{{ item.fileName }}<span v-show="!item.isDirectory && item.fileType">.{{ item.fileType }}</span></span>
                                </div>
                            </div>
                            <div class="d-flex a-center fileSize">
                                <span>{{ calculateSize(item.fileSize) }}</span>
                            </div>
                            <div class="d-flex a-center lastUpdateTime">
                                <span>{{ item.lastUpdateTime }}</span>
                            </div>
                            <div class="operate d-flex a-center j-center">
                                <el-link v-show="!item.isDirectory" :underline="false" type="info" @click="downloadFile(item)">下载</el-link>
                                <el-link v-show="item.isDirectory" style="margin-left: 5px;" :underline="false" type="info" @click="zipFile(item)">压缩</el-link>
                                <el-link v-show="item.fileType==='zip'" style="margin-left: 5px;" :underline="false" type="info" @click="unZipFile(item)">解压</el-link>
                                <el-link :underline="false" type="info" style="margin-left: 5px;" @click="reName(item)">重命名</el-link>
                                <el-link v-show="!item.isDirectory" :underline="false" type="info" style="margin-left: 5px;" @click="syncToPhoneSingle(item)">同步到手机</el-link>
                                <el-link :underline="false" type="info" style="margin-left: 5px;" @click="removeFile(item)">删除</el-link>
                            </div>
                        </div>
                    </el-scrollbar>
                </div>
            </el-row>
        </el-tab-pane>
        <el-tab-pane label="手机端文件" name="phone">
            <el-row style="padding-left: 0!important;">
                <div class="d-flex j-sb a-center width100">
                    <div class="d-flex a-center">
                        <el-button size="mini" type="primary" @click="phoneCreateFile">新建文件(夹)</el-button>
                        <el-button size="mini" style="margin-left: 5px;" type="primary" @click="phoneInitSyncDir">初始化同步目录</el-button>
                        <el-button size="mini" style="margin-left: 5px;" type="primary" @click="phoneInitOfficialExample">初始化官方示例</el-button>
                        <el-button size="mini" style="margin-left: 5px;" type="primary" @click="phoneDownLoadGameScript">初始化脚手架项目</el-button>
                        <el-button size="mini" style="margin-left: 5px;" type="primary" @click="phoneInitFile">初始化运行程序</el-button>
                        <el-button size="mini" style="margin-left: 5px;" type="primary" @click="phoneRemoteRunScript">远程运行程序</el-button>
                        <el-button size="mini" style="margin-left: 5px;" type="primary" @click="phoneRemoteStopScript">远程停止程序</el-button>
                        <!--<el-button size="mini" style="margin-left: 5px;" type="primary" @click="phoneAutoJsToolHotUpdate">远程更新工具箱APP</el-button>-->
                    </div>
                </div>
            </el-row>
            <el-row style="padding-left: 0!important;">
                <div class="d-flex j-sb a-center breadcrumbWrap" style="margin-top: 10px;margin-bottom: 10px;">
                    <el-breadcrumb separator="/">
                        <el-breadcrumb-item v-for="(item, i) in phoneBreadcrumbList" :key="i" class="pointer textHover" :class="{'endBreadcrumb': i !== 0 && i === phoneBreadcrumbList.length - 1, 'hoverBreadcrumb': phoneBreadcrumbList.length > 1 && i !== phoneBreadcrumbList.length - 1 }">
                            <span @click="phoneBreadcrumbChange(item, i)">{{ item.label }}</span>
                        </el-breadcrumb-item>
                    </el-breadcrumb>
                    <span class="primary-text-color font-14 keep-all">共{{ phoneFileList.length }}个</span>
                </div>
            </el-row>
            <el-row style="padding-left: 0!important;">
                <div class="d-flex a-center fileOperate primary-text-color pl-1">
                    <el-tooltip class="item" v-if="phoneCopyFileList.length>0" effect="dark" :disabled="!phoneCopyFileNames" :content="phoneCopyFileNames" placement="top-start">
                        <span class="fileTips" >复制{{ phoneCopyFileList.length }}个文件(夹)</span>
                    </el-tooltip>
                    <el-tooltip class="item" v-else-if="phoneMoveFileList.length>0" effect="dark" :disabled="!phoneAllowMoveFileNames" :content="phoneAllowMoveFileNames" placement="top-start">
                        <span class="fileTips" >移动{{ phoneAllowMoveFileList.length }}个文件(夹)</span>
                    </el-tooltip>
                    <el-tooltip class="item" v-else="phoneCheckFileCount>0" effect="dark" :disabled="!phoneCheckFileNames" :content="phoneCheckFileNames" placement="top-start">
                        <span class="fileTips" >已选{{ phoneCheckFileCount }}个文件(夹)</span>
                    </el-tooltip>
                    <div class="operate d-flex a-center j-center">
                        <el-link v-if="phoneCheckFileCount>0" :underline="false" type="info" style="margin-left: 5px;" @click="phoneOperateFun('copy')">复制</el-link>
                        <el-link v-if="phoneCheckFileCount>0" :underline="false" type="info" style="margin-left: 5px;" @click="phoneOperateFun('move')">移动</el-link>
                        <el-link v-if="phoneCheckFileCount>0" :underline="false" type="info" style="margin-left: 5px;" @click="phoneOperateFun('remove')">删除</el-link>
                        <el-link v-if="phoneCopyFileList.length>0" :underline="false" type="info" style="margin-left: 5px;" @click="phoneOperateFun('paste')">粘贴到</el-link>
                        <el-link v-if="phoneMoveFileList.length>0" :underline="false" :disabled="!phoneAllowMoveFileList.length>0" type="info" style="margin-left: 5px;" @click="phoneOperateFun('moveTo')">移动到</el-link>
                        <el-link v-if="phoneCheckFileCount>0" :underline="false" type="info" style="margin-left: 5px;" @click="phoneOperateFun('syncToWeb')">同步到web</el-link>
                        <el-link v-if="phoneCopyFileList.length>0 || phoneMoveFileList.length>0" :underline="false" type="info" style="margin-left: 5px;" @click="phoneOperateFun('cancel')">取消</el-link>
                        <span v-if="phoneCheckFileCount>0" style="font-size: 12px;margin-left: 5px;color: #cf0808">文件夹不支持复制！！！</span>
                    </div>
                </div>
            </el-row>
            <el-row style="padding-left: 0!important;">
                <div class="fileTableList" v-loading="phoneFileLoading">
                    <div class="fileList-head d-flex a-center">
                        <div class="d-flex a-center phoneFileName">
                            <el-checkbox v-model="phoneCheckAllFile" @change="phoneCheckAllFileChange" />
                            <span style="margin-left: 8px">文件名</span>
                        </div>
                        <div class="phoneOperate">操作</div>
                    </div>
                    <el-scrollbar class="right-scrollbar-wrap" :key="phoneFileTableRandomKey">
                        <div v-for="(item,index) in phoneFileList" :key="'phone'+index" class="fileList-head fileList-body d-flex a-center">
                            <div class="d-flex a-center phoneFileName">
                                <el-checkbox v-model="item.check" class="mr-5" @dblclick.stop.native />
                                <div class="fileNameWrap pointer d-flex a-center flex-1 mr-10" @dblclick="phoneFileNameDbClick(item)">
                                    <span class="mr-10 white-noWrap ellipsis-1 text-fileName mt-0" :title="item.fileName">{{ item.fileName }}<span v-show="!item.isDirectory && item.fileType">.{{ item.fileType }}</span></span>
                                </div>
                            </div>
                            <div class="phoneOperate d-flex a-center j-center">
                                <el-link v-show="item.fileType==='js'" :underline="false" type="info" @click="phoneRunScriptPath(item)">运行</el-link>
                                <el-link :underline="false" type="info" style="margin-left: 5px;" @click="phoneOneKeyDownLoad(item)">下载</el-link>
                                <el-link v-show="item.isDirectory" style="margin-left: 5px;" :underline="false" type="info" @click="phoneZipFile(item)">压缩</el-link>
                                <el-link v-show="item.fileType==='zip'" style="margin-left: 5px;" :underline="false" type="info" @click="phoneUnZipFile(item)">解压</el-link>
                                <el-link :underline="false" type="info" style="margin-left: 5px;" @click="phoneReName(item)">重命名</el-link>
                                <el-link v-show="!item.isDirectory" :underline="false" type="info" style="margin-left: 5px;" @click="syncToWebSingle(item)">同步到web</el-link>
                                <el-link :underline="false" type="info" style="margin-left: 5px;" @click="phoneRemoveFile(item)">删除</el-link>
                            </div>
                        </div>
                    </el-scrollbar>
                </div>
            </el-row>
        </el-tab-pane>
    </el-tabs>
    <el-dialog  :visible.sync="fileEditVisible" :title="navigatePath + '/' + fileEditorName" center :close-on-click-modal="false" width="100vw" height="100vh" custom-class="fileEditorDialog">
        <div id="fileEditor" style="height: 85vh;width: 100%;">
        </div>
        <span slot="footer" class="dialog-footer">
          <el-button type="primary"  @click.stop.native="saveFileEditorContent">
            保存
          </el-button>
          <el-button type="info" @click.stop.native="closeFileEditorDialog">
            关闭
          </el-button>
        </span>
    </el-dialog>
    <!-- width="100vw" height="100vh" custom-class="fileEditorDialog" -->
    <el-dialog  :visible.sync="phoneFileEditVisible" :title="phoneFileEditorName"  fullscreen center :close-on-click-modal="false" :close-on-press-escape="false" :modal="false" :before-close="confirmClose">
        <div class="fileNameArr">
            <div v-for="(item,index) in phoneFileCacheArr" :key="index"  :class="{'fileNameItem': true,'fileNameSelectItem': index === phoneFileSelectIndex}">
                <el-tooltip class="item"  effect="dark" :disabled="!item.fileSavePath" :content="item.fileSavePath" placement="top-start">
                    <div @click.stop="phoneFileEditorArrClick(index)">
                        <span> {{item.sourceFileContent === item.fileContent ? item.fileName : '*'+ item.fileName }}</span>
                        <span @click.stop="closePhoneEditorArrClick(index)">关闭</span>
                    </div>
                </el-tooltip>
            </div>
        </div>
        <div id="phoneFileEditor" style="height: 85vh;width: 100%;">
        </div>
        <span slot="footer" class="dialog-footer">
          <el-button type="primary"  @click.stop.native="phoneSaveFileEditorContent">
            保存
          </el-button>
          <el-button type="info" @click.stop.native="phoneMinFileEditorDialog">
            最小化
          </el-button>
        </span>
    </el-dialog>
    <el-dialog :visible.sync="phoneImagePreviewVisible" :title="phoneFileEditorName" center :close-on-click-modal="false" width="100vw" height="100vh" custom-class="fileEditorDialog">
        <div style="height: 85vh;width: 100%;display: inline-flex;justify-content: center;align-items: center;">
            <img id="imagePreview" :src="phoneImageBase64" />
        </div>
        <span slot="footer" class="dialog-footer">
          <el-button type="info" @click.stop.native="phoneCloseImagePreviewDialog">
            关闭
          </el-button>
        </span>
    </el-dialog>
</div>